{# Renamed from lead_card to opportunity_card for marketplace terminology #}
{% macro render_opportunity_card(opportunity, show_actions=True, current_user=None) %}
<article class="lead-card">
    <header class="lead-card-header">
        <div class="lead-meta">
            <span class="category-badge">
                {{ opportunity.category.value | replace('_', ' ') | title }}
            </span>
            {% if opportunity.time_sensitivity == 'urgent' %}
            <span class="urgency-badge urgent">⚡ Urgent</span>
            {% elif opportunity.time_sensitivity == 'moderate' %}
            <span class="urgency-badge moderate">⏰ Time-sensitive</span>
            {% endif %}
        </div>
        <time class="lead-date" datetime="{{ opportunity.submitted_at }}">
            {{ opportunity.submitted_at | format_relative }}
        </time>
    </header>
    
    <h3 class="lead-card-title">{{ opportunity.title }}</h3>
    
    <p class="lead-card-summary">{{ opportunity.summary | truncate(300) }}</p>
    
    <div class="lead-card-evidence">
        <strong>Evidence:</strong>
        {% for evidence in opportunity.evidence_types[:4] %}
        <span class="evidence-tag">{{ evidence | replace('_', ' ') }}</span>
        {% endfor %}
        {% if opportunity.evidence_types | length > 4 %}
        <span class="evidence-more">+{{ opportunity.evidence_types | length - 4 }} more</span>
        {% endif %}
    </div>
    
    {% if opportunity.geographic_scope %}
    <div class="lead-card-scope">
        <strong>Scope:</strong> {{ opportunity.geographic_scope | join(', ') }}
    </div>
    {% endif %}
    
    {% if show_actions %}
    <footer class="lead-card-footer">
        <a href="/marketplace/{{ opportunity.id }}" class="btn btn-secondary btn-sm">
            View Details
        </a>
        {# Updated role check from journalist to vendor #}
        {% if current_user and current_user.role.value == 'vendor' %}
        <a href="/marketplace/{{ opportunity.id }}#interest-form" class="btn btn-primary btn-sm">
            Express Interest
        </a>
        {% endif %}
    </footer>
    {% endif %}
</article>
{% endmacro %}
