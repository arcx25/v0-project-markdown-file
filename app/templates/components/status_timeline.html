{# Adapted timeline from journalist/source to vendor/buyer model #}
{% macro render_opportunity_timeline(opportunity) %}
<div class="status-timeline">
    <div class="timeline-item {% if opportunity.created_at %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Created</h4>
            <time>{{ opportunity.created_at | format_date }}</time>
        </div>
    </div>
    
    <div class="timeline-item {% if opportunity.submitted_at %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Submitted for Review</h4>
            {% if opportunity.submitted_at %}
            <time>{{ opportunity.submitted_at | format_date }}</time>
            {% else %}
            <span class="pending">Pending</span>
            {% endif %}
        </div>
    </div>
    
    <div class="timeline-item {% if opportunity.status.value == 'published' or opportunity.matched_at %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Published</h4>
            {% if opportunity.reviewed_at and opportunity.status.value != 'draft' %}
            <time>{{ opportunity.reviewed_at | format_date }}</time>
            {% else %}
            <span class="pending">Pending review</span>
            {% endif %}
        </div>
    </div>
    
    <div class="timeline-item {% if opportunity.matched_at %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Matched with Vendor</h4>
            {% if opportunity.matched_at %}
            <time>{{ opportunity.matched_at | format_date }}</time>
            {% else %}
            <span class="pending">Awaiting match</span>
            {% endif %}
        </div>
    </div>
    
    <div class="timeline-item {% if opportunity.completed_at %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Completed</h4>
            {% if opportunity.completed_at %}
            <time>{{ opportunity.completed_at | format_date }}</time>
            {% if opportunity.completion_url %}
            <a href="{{ opportunity.completion_url }}" class="completion-link" target="_blank">
                View Results →
            </a>
            {% endif %}
            {% else %}
            <span class="pending">In progress</span>
            {% endif %}
        </div>
    </div>
</div>
{% endmacro %}

{% macro render_listing_timeline(listing) %}
<div class="status-timeline">
    <div class="timeline-item completed">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Created</h4>
            <time>{{ listing.created_at | format_date }}</time>
        </div>
    </div>
    
    <div class="timeline-item {% if listing.status.value != 'draft' %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Submitted for Review</h4>
            {% if listing.status.value != 'draft' %}
            <span class="completed-text">✓</span>
            {% else %}
            <span class="pending">Add tiers and submit</span>
            {% endif %}
        </div>
    </div>
    
    <div class="timeline-item {% if listing.verified_at %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Verified & Published</h4>
            {% if listing.verified_at %}
            <time>{{ listing.verified_at | format_date }}</time>
            {% else %}
            <span class="pending">Pending verification</span>
            {% endif %}
        </div>
    </div>
    
    {% if listing.funding_goal_usd %}
    <div class="timeline-item {% if listing.progress_percent >= 100 %}completed{% endif %}">
        <div class="timeline-marker"></div>
        <div class="timeline-content">
            <h4>Funding Goal Reached</h4>
            {% if listing.progress_percent >= 100 %}
            <span class="completed-text">✓ Goal met!</span>
            {% else %}
            <span class="pending">{{ listing.progress_percent }}% complete</span>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endmacro %}
